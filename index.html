---
layout: default
---
{%- if site.data.status.description -%}
<div class="mkdwn">{{ site.data.status.description | markdownify }}</div>
{%- else -%}
<div class="mkdwn">
  <p>
    We continuously monitor the status of {{ site.data.status.title | default: 'the Status Page' }} and all related
    services. If there are any interruptions in service, a note will be posted here.
  </p>
</div>
{%- endif -%}

{%- include current-status.html -%}
{%- include current-components.html -%}

<section class="my-5 incidents">
  <h3>Past Incidents</h3>
  {%- assign grouped = site.data.status.incidents | group_by_exp:"row","row.timestamp | default: row.updates[0].timestamp | date: '%F'" -%}

  {%- assign dates = site.time | date: '%F' -%}
  {%- for n in (1..14) -%}
  {%- assign offset = n | times: 86400 -%}
  {%- capture dates -%}{{dates}},{{ site.time | date: '%s' | minus: offset | date: "%F" }}{%- endcapture -%}
  {%- endfor -%}
  {%- assign dates = dates | split: "," | uniq -%}

  {%- for day in dates -%}
  {%- assign group = grouped | where: "name", day | first -%}
  <div class="mt-4">
    <h4 class="border-bottom">
      {{ day | date: "%b %e" }}
      {%- assign formal = day | date: "%d" -%}
      {%- if formal == "01" -%}st{%- elsif formal == "02" -%}nd{%- elsif formal == "03" -%}rd{%- else -%}th{%- endif -%}
      {{ day | date: ", %Y" }}
    </h4>
    {%- for incident in group.items -%}
    <div class="incident mt-3">
      {%- if incident.title -%}<h5>{{ incident.title }}</h5>{%- endif -%}
      {%- if incident.body -%}<div class="mkdwn">{{ incident.body | markdownify }}</div>{%- endif -%}
      {%- for update in incident.updates -%}
        <div class="update">
        {%- if update.title -%}<p><strong>{{ update.title }}</strong></p>{%- endif -%}
        {%- if update.body -%}<div class="mkdwn">{{ update.body | markdownify }}</div>{%- endif -%}
        {%- if update.timestamp -%}<p><small class="d-block text-secondary">{{ update.timestamp | date: '%F %R' }}</small></p>{%- endif -%}
        </div>
      {%- else -%}
      {%- if incident.timestamp -%}<p><small class="d-block text-secondary">{{ incident.timestamp | date: '%F %R' }}</small></p>{%- endif -%}
      {%- endfor -%}
    </div>
    {%- else -%}
    <p class="text-secondary">No incidents reported today.</p>
    {%- endfor -%}
  </div>
  {%- endfor -%}
</section>
